/*jshint  esnext:true*/
const DESC_MAX_LENGTH = 140;
const SP_LOGO = 'data:image/png;base64,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';

class Script {
	process_incoming_request({request}) {
	  const data = request.content;

    let message = {
      icon_url: SP_LOGO
      , attachments: []
    };

    // 3rd party component status changes
    if (data.component) {
      let body = '**Component: ' + data.component.name + '**\n\n**Status: ' + data.component.status + '**';
      message.attachments.push({color: '#F30', title: data.page.status_description, text: body});
    }

    // Our incidents
    if (data.incident) {
      message.attachments.push({color: '#F80', title: data.page.status_description, text: data.incident.incident_updates[0].body});
    }
    if (message.attachments.length) {
  		return {content:message};
    }
	}
}
